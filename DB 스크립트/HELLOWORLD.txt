
-- 테이블 삭제 --
---------------------------------------------------------------
DROP TABLE MEMBER CASCADE CONSTRAINTS;
DROP TABLE GUEST_BOOK CASCADE CONSTRAINTS;
DROP TABLE BOARD CASCADE CONSTRAINTS;
DROP TABLE DIARY CASCADE CONSTRAINTS;
DROP TABLE COMMENTS CASCADE CONSTRAINTS;
DROP TABLE TODAY CASCADE CONSTRAINTS;
DROP TABLE PHOTO CASCADE CONSTRAINTS;

-- 시퀀스 삭제 --
----------------------------------------------------------------
DROP SEQUENCE MEMBER_SEQ;
DROP SEQUENCE BOARD_SEQ;
DROP SEQUENCE DIARY_SEQ;
DROP SEQUENCE COMMENTS_SEQ;
DROP SEQUENCE GUEST_BOOK_SEQ;
DROP SEQUENCE PHOTO_SEQ;
DROP SEQUENCE TODAY_SEQ;

-- 테이블 생성 --
-----------------------------------------------------------------
CREATE TABLE MEMBER(
    U_IDX NUMBER PRIMARY KEY NOT NULL,
    U_ID VARCHAR2(50) UNIQUE NOT NULL,
    PWD VARCHAR2(50) NOT NULL,
    NICKNAME VARCHAR2(30) UNIQUE NOT NULL,
    NAME VARCHAR2(30),
    PHONE VARCHAR2(30),
    BIRTH DATE,
    EMAIL VARCHAR2(50),
    GENDER VARCHAR2(10)
);

CREATE TABLE DIARY(
    D_IDX NUMBER(5) PRIMARY KEY NOT NULL,
    U_IDX NUMBER(5),
    TITLE VARCHAR2(100),
    CONTENT VARCHAR2(800),
    REGDATE DATE,
    HIT NUMBER(10),
    CONSTRAINT FK_DIARY FOREIGN KEY(U_IDX) REFERENCES MEMBER(U_IDX)
);

CREATE TABLE PHOTO(
    P_IDX NUMBER PRIMARY KEY,
    U_IDX NUMBER NOT NULL,
    TITLE VARCHAR2(60) NOT NULL,
    CONTENT VARCHAR2(3000),
    ORIFILENAME VARCHAR2(300),
    FILESYSNAME VARCHAR2(300),
    REGDATE DATE DEFAULT(SYSDATE),
    MODIDATE DATE,
    FOREIGN KEY (U_IDX) REFERENCES MEMBER (U_IDX)
);
    
CREATE TABLE TODAY(
	TODAYCNT NUMBER,
	IP VARCHAR2(20),
	REGDATE DATE,
	U_IDX NUMBER REFERENCES MEMBER(U_IDX)
);

CREATE TABLE BOARD(
    B_IDX NUMBER(5) PRIMARY KEY NOT NULL,
    U_IDX NUMBER(5),
    TITLE VARCHAR2(200),
    CONTENT VARCHAR2(1500),
    REGDATE DATE,
    NICKNAME VARCHAR2(30),
    HIT NUMBER(10),
    CONSTRAINT FK_BOARD FOREIGN KEY(U_IDX) REFERENCES MEMBER(U_IDX)
);

CREATE TABLE GUEST_BOOK(
    G_IDX NUMBER(5) PRIMARY KEY NOT NULL,
    U_IDX NUMBER(5),
    CONTENT VARCHAR2(800),
    REGDATE DATE,
    NICKNAME VARCHAR2(30),
    CONSTRAINT FK_GUEST FOREIGN KEY(U_IDX) REFERENCES MEMBER(U_IDX)
);

CREATE TABLE COMMENTS(
    C_IDX NUMBER(5) PRIMARY KEY NOT NULL,
    G_IDX NUMBER(5),
    D_IDX NUMBER(5),
    B_IDX NUMBER(5),
    P_IDX NUMBER(5),
    NICKNAME VARCHAR2(30),
    REGDATE DATE,
    CONTENT VARCHAR2(800),
    CONSTRAINT FK_COMMENT_G FOREIGN KEY(G_IDX) REFERENCES GUEST_BOOK(G_IDX),
    CONSTRAINT FK_COMMENT_D FOREIGN KEY(D_IDX) REFERENCES DIARY(D_IDX),
    CONSTRAINT FK_COMMENT_B FOREIGN KEY(B_IDX) REFERENCES BOARD(B_IDX),
    CONSTRAINT FK_COMMENT_P FOREIGN KEY(P_IDX) REFERENCES PHOTO(P_IDX)
);

-- 시퀀스 추가 --
---------------------------------------------------------------
CREATE SEQUENCE MEMBER_SEQ NOCACHE;
CREATE SEQUENCE BOARD_SEQ NOCACHE;
CREATE SEQUENCE DIARY_SEQ NOCACHE;
CREATE SEQUENCE COMMENTS_SEQ NOCACHE;
CREATE SEQUENCE GUEST_BOOK_SEQ NOCACHE;
CREATE SEQUENCE PHOTO_SEQ NOCACHE;
CREATE SEQUENCE TODAY_SEQ NOCACHE;
COMMIT;